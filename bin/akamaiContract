
const Tool = require('tool');
const Noi = require('noi');
const { Contract } = Noi;

function dump_dto( dto ) {
    console.log( JSON.stringify(dto) );
}

function print_id( id ) {
    console.log( id );
}

function per_contract( dto ) {
    dto.map( print_id );
}

function print_contract( contract ) {
    console.log( contract.contractId + "  :  " + contract.contractTypeName );
}

function print_details( dto ) {
    console.log( "Account: " + dto.accountId );
    dto.contracts.items.map( print_contract );
}

var commands = {
    list: function () {
        if ( this.verbose ) { // use the PAPI API for details
            Contract.contracts_details( print_details );
            return;
        }
        Contract.contracts( per_contract );
    },
    show: function ( id ) {
        Contract.contract( id, dump_dto );
    },
    "reporting-groups": function () {
        Contract.reporting_groups( dump_dto );
    },
    cpcodes: function ( contractId ) {
        Contract.cpcodes( contractId, dump_dto );
    }
};

var tool = new Tool( commands );

tool.evaluate( process.argv );

/* vim: set autoindent expandtab sw=4 syntax=javascript: */
